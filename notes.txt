Quickcom tel com PRM trunk Prefix:001 USD


Questions to ask


==================================

to do

jerasoft cleaning is failing see why?

===================================

issues

resolve the date issues.

==============================


future considerations


track the emails that have been processed so the system wont process them again
like by keeping a meta file etc...

see the serach time complexity in both cases.

harden the case of recleaning once failed files everytime like add max 2 tries.



=============================================================================


now inside this: ``#________________ Manual Date Verification _____________________



#_______________ Jerasoft Script _____________``

i want to add the logic which is this:

- go inside the attachments folder  and from there go inside each directory
inside that look for the metadata file inside that look for a flag named 'date_verification_ingestion' if its true then skip that folder and move forward if its not there or its false than pick that folder an move to the next step. at the end of all the processing set this flag to true

- in the second step check for a flag 'attachments' if avilable good then go inside it if it contains a path or paths then just pick the first path and ignores rest save the file path in the temperory variable if it does contain any path than simply skip the directory other wise move to the next step.

- now in this step fetch the relevant details from the meta file:
subject, sender, receivedDateTime_raw,processed_at_utc,  directory 
here's the catch the directory contains the path to the folder not to the file so you have to append it with the file path which we have saved at top considering we are on linux server.

- now in this step we have to get few more details to fill all the table fields

which is this: `preview_cache`

in this field we have to pass some of the sample fields from the attachments file like first 200 rows 

so lets see how to open files and get the details.

- if the file is csv then simply use the pandas.read_csv and fetch the first 200 rows
- if its is in somer other format like excel, xlsx ,etc..
then we need to define some methods will fallbacks etc..

so if the extension is not in csv than we will be tackling these
('.xlsx', '.xlsm', '.xls')

if  `if ext == '.xls':`








for reference here's the meta data file sample: ``{
    "subject": "Re: HAYO FULL A-Z REPLACE ORIG PLATINUM AIRON TECH LLC PREFIX:NONE",
    "sender": "rates@airontel.com",
    "company": "Re HAYO FULL A-Z REPLACE ORIG PLATINUM AIRON TECH NONE",
    "prefix": null,
    "date_utc": "2025-10-02",
    "time_utc": "17:12:11",
    "directory": "/home/sufyan/code/rate-sheet-automation/attachments/rates_at_airontel.com_20251002_171211",
    "internetMessageId": "<64E143B4-2B2E-4B96-BBEA-F414430223A8@airontel.com>",
    "attachment_count": 1,
    "attachments": [
        "rates-all-Hayo-for-AIRON_FZC_LLC--all_time-2025-10-08_000000.xlsx"
    ],
    "receivedDateTime_raw": "2025-10-02T17:12:11Z",
    "processed_at_utc": "2025-10-02T17:15:09Z",
    "subject_parsing_source": "regex",
    "best_table_name": "TERM VOXPACE INC CC PREFIX:NONE",
    "human_eval_details_jerasoft": {
        "file": "rates-all-Hayo-for-AIRON_FZC_LLC--all_time-2025-10-08_000000_jerasoft_comparison.xlsx",
        "rows": 0
    },
    "need_human_eval_jerasoft": true,
    "jerasoft_preprocessed": true,
    "preprocessed_results": {
        "rates-all-Hayo-for-AIRON_FZC_LLC--all_time-2025-10-08_000000.xlsx": true,
        "rates-all-Hayo-for-AIRON_FZC_LLC--all_time-2025-10-08_000000_jerasoft_comparison.xlsx": false
    },
    "human_eval_details_pre": {
        "rates-all-Hayo-for-AIRON_FZC_LLC--all_time-2025-10-08_000000.xlsx": {
            "rows": 28536
        }
    },
    "need_human_eval_pre": false,
    "comparision_result": {
        "result": "comparison skipped: comparison file failed preprocessing"
    },
    "already_pushed": true
}``